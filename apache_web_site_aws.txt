
*** New instructions (12/2025)

Using uv makes a lot of the setup pretty painless. I usually put the code in 
/var/www, so to install:

cd /var/www
git clone https://github.com/jmoonware/weathersite
uv sync

Don't forget to add mod_wsgi as a dependency beforehand using uv via:

uv add mod_wsgi

If this is a fresh cloud instance apache2 might need to be installed via:
sudo apt install apache2
sudo apt install apache2-dev

Got this info from https://flask.palletsprojects.com/en/2.0.x/deploying/mod_wsgi/. Not sure it is needed but:

sudo apt install libapache2-mod-wsgi-py3

BTW, it is very important the the mod_wsgi module matches the version of 
Python being used - I haven't tested what happens if the uv venv python version doesn't match the system python version 

In the <project_name>.wsgi file (change <project_name> to whatever the project name is, eg 'weathersite'):

	import sys
	sys.path.insert(0,'/var/www/<project_name>')
	sys.stdout=sys.stderr
	from <project_name> import server as application
	
you will need a <project_name>.py file with a couple lines like this somewhere (put after all initialization code for the app):

<project_name>.py
	<other init code...>
	server=flask.Flask(__name__)
	app=dash.Dash(__name__, external_stylesheets=external_stylesheets,server=server)

Create weathersite.exampledomain.org.conf file in /etc/apache2/site-enabled (where "weathersite.exampledomain.org" is the dns of the server - see update_dns.sh for details)

An example of this file is checked in as weathersite.exampledomain.org.conf. Follow the instructions from Let's Encrypt to generate a proper certificate for the site.

Note that if your program is writing to the filesystem, 
then the user/group default is www-data, so set up
a directory with the right ownership 
e.g, to set up a folder /opt/WebSite for data to be written to by the project above,

sudo mkdir /opt/WebSite
sudo chown www-data /opt/WebSite
sudo chgrp www-data /opt/WebSite
sudo chmod 644 /opt/WebSite

Edit the /etc/apache2/ports.conf file to Listen on the same port as in the .conf file in sites-enabled.

Also, make sure the server firewall is configured to let connections 
happen on whatever port is chosen

then sudo systemctl restart apache2

Look in /var/log/apache2/errors.log (or others in this directory)
for what happened (or didn't)
 
sudo systemctl status apache2

